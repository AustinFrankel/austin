@import "tailwindcss";
@plugin "@tailwindcss/typography";

:root {
  /* Theme tokens */
  --bg: #ffffff;
  --fg: #0b1220;
  --muted: #6b7280;
  --surface: #f8fafc;
  --brand: #0ea5e9;
  --brand-contrast: #0b1220;

  /* Backwards-compat with existing styles */
  --card: var(--surface);
  --ring: #3b82f6;

  /* Accent hues used for decorative glows; controlled by ThemeProvider */
  --accent: 59 130 246; /* rgb tuple string */
  --accent-2: 139 92 246;
  --accent-3: 16 185 129;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0b1220;
    --fg: #f8fafc;
    --muted: #9aa4b2;
    --surface: #111827;
    --brand: #38bdf8;
    --brand-contrast: #0b1220;
    --ring: #93c5fd;
  }
}

html { color-scheme: light dark; scroll-behavior: smooth; font-size: calc(16px * var(--text-scale, 1)); transition: font-size .28s ease; }

html[data-theme="light"] {
  --bg: #ffffff;
  --fg: #0b1220;
  --muted: #6b7280;
  --surface: #f8fafc;
  --brand: #0ea5e9;
  --brand-contrast: #0b1220;
}
html[data-theme="dark"] {
  --bg: #0b1220;
  --fg: #f8fafc;
  --muted: #9aa4b2;
  --surface: #111827;
  --brand: #38bdf8;
  --brand-contrast: #0b1220;
}

html[data-textsize="s"] { --text-scale: 0.94; }
html[data-textsize="m"] { --text-scale: 1; }
html[data-textsize="l"] { --text-scale: 1.12; }

body { background-color: var(--bg); color: var(--fg); font-family: Arial, Helvetica, sans-serif; }

/* Token utility helpers (for convenience alongside Tailwind arbitrary values) */
.text-fg { color: var(--fg); }
.text-muted { color: var(--muted); }
.bg-surface { background-color: var(--surface); }
.bg-brand { background-color: var(--brand); }
.text-brand-contrast { color: var(--brand-contrast); }

/* Advanced background: soft grid + vignette + diagonal noise (original style) */
.bg-grid {
  /* Symmetrical grid centered on viewport with subtle vignette; hue ties to accent */
  background-image:
    linear-gradient(120deg, rgb(var(--accent) / 0.03), transparent 35%),
    radial-gradient(1000px 700px at 50% 0%, rgb(var(--accent) / 0.10), transparent 65%),
    linear-gradient(rgb(100 116 139 / 0.10) 1px, transparent 1px),
    linear-gradient(90deg, rgb(100 116 139 / 0.10) 1px, transparent 1px);
  background-size: auto, 18px 18px, 18px 18px;
  background-position: center top, center 12px, center;
  background-blend-mode: normal;
  position: relative;
}
/* Tune grid strength per theme for better readability */
html[data-theme="light"] .bg-grid {
  background-image:
    linear-gradient(120deg, rgb(var(--accent) / 0.025), transparent 35%),
    radial-gradient(1000px 700px at 50% 0%, rgb(var(--accent) / 0.055), transparent 65%),
    linear-gradient(rgb(100 116 139 / 0.045) 1px, transparent 1px),
    linear-gradient(90deg, rgb(100 116 139 / 0.045) 1px, transparent 1px);
  background-position: center top, center 9px, center;
}
html[data-theme="dark"] .bg-grid {
  background-image:
    radial-gradient(1000px 700px at 50% 0%, rgb(var(--accent) / 0.22), transparent 65%),
    linear-gradient(rgb(100 116 139 / 0.13) 1px, transparent 1px),
    linear-gradient(90deg, rgb(100 116 139 / 0.13) 1px, transparent 1px);
  background-position: center top, center 9px, center;
}

/* Extra-assurance: paint grid as a fixed overlay to ensure visibility across all sections */
/* Disable secondary fixed grid overlay to avoid doubled lines */
.bg-grid::before { content: none; }
html[data-theme="light"] .bg-grid::before { content: none; }

.card { @apply rounded-2xl shadow-lg shadow-black/5 dark:shadow-black/20 border border-black/15 dark:border-white/10; background-color: var(--surface); position: relative; overflow: hidden; }
.container-px { @apply px-4 sm:px-6 lg:px-8; }

.btn-primary { background-color: var(--brand); color: var(--brand-contrast); border-radius: 9999px; transition: background-color .15s ease, transform .2s ease, box-shadow .2s ease; position: relative; overflow: hidden; }
.btn-primary:hover { filter: brightness(0.98); }
.btn-outline { border: 1px solid rgb(0 0 0 / 0.2); color: var(--fg); border-radius: 9999px; position: relative; overflow: hidden; transition: transform .2s ease, box-shadow .2s ease, background-color .2s ease; background-color: color-mix(in oklab, var(--surface), transparent 35%); backdrop-filter: saturate(140%) blur(6px); }
.btn-outline:hover { background-color: rgb(0 0 0 / 0.05); }
.dark .btn-outline { border-color: rgb(255 255 255 / 0.22); }
.dark .btn-outline:hover { background-color: rgb(255 255 255 / 0.08); }
/* Light theme: slightly filled outline buttons for contrast on white cards */
html[data-theme="light"] .btn-outline { background-color: color-mix(in oklab, var(--surface), white 20%); }
.dark .btn-outline { border-color: rgb(255 255 255 / 0.22); }
.dark .btn-outline { background-color: color-mix(in oklab, var(--surface), black 20%); }

/* Hover graphics driven by --bx/--by (set by HoverGlowClient) */
.btn-primary::after, .btn-outline::after, .card::after {
  content: ""; position: absolute; inset: -1px; pointer-events: none; opacity: 0; transition: opacity .25s ease;
  background:
    radial-gradient(220px 220px at var(--bx, -100px) var(--by, -100px), rgb(var(--accent) / 0.25), transparent 60%),
    radial-gradient(360px 360px at calc(var(--bx, -100px) + 60px) calc(var(--by, -100px) + 40px), rgb(var(--accent-2) / 0.18), transparent 70%);
  mix-blend-mode: overlay;
}
/* Only the innermost hovered element should glow. We rely on data-glow-active set by HoverGlowClient */
.btn-primary[data-glow-active]::after, .btn-outline[data-glow-active]::after, .card[data-glow-active]::after { opacity: 1; }

/* Disable grid-overlay on hover inside boxes (cards/buttons) sitewide */
.card::before, .btn-primary::before, .btn-outline::before { display: none !important; }

/* Elevation + border accent on hover */
.card:hover { transform: translateY(-4px); box-shadow: 0 18px 36px rgb(0 0 0 / .14); }
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 24px rgb(59 130 246 / .20); }
.btn-outline:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgb(0 0 0 / .08); }
.card:focus-visible { outline: 2px solid rgb(var(--accent)); outline-offset: 2px; }

.prose h1, .prose h2, .prose h3 { @apply font-semibold mt-6; }
.prose p { @apply mt-4 leading-7; color: var(--fg); }
.prose ul { @apply list-disc pl-6 mt-4; }

/* Prose token theming */
.prose { color: var(--fg); }
.prose :where(h1,h2,h3,h4) { color: var(--fg); }
.prose :where(p,li,blockquote,figcaption) { color: var(--muted); }
.dark .prose { color: var(--fg); }
.dark .prose :where(p,li,blockquote,figcaption) { color: var(--muted); }

/* Readability chip utility â€” disabled in light mode per request */
.text-bg { padding: .15rem .35rem; border-radius: .5rem; }
html[data-theme="light"] .text-bg { background-color: transparent; color: inherit; box-shadow: none; padding: 0; border-radius: 0; }
html[data-theme="dark"] .text-bg { background-color: transparent; color: var(--fg); }

/* Cursor gradient that follows the mouse: visible on both themes */
/* Cursor gradient (beefed up for light theme contrast) */
.cursor-glow { 
  position: fixed; inset: 0; pointer-events: none; z-index: 40;
  background: radial-gradient(260px 260px at var(--mx,50%) var(--my,50%), rgb(var(--accent) / 0.18), transparent 65%),
              radial-gradient(340px 340px at calc(var(--mx,50%) + 60px) calc(var(--my,50%) + 40px), rgb(var(--accent-2) / 0.12), transparent 70%),
              radial-gradient(420px 420px at calc(var(--mx,50%) - 80px) calc(var(--my,50%) - 20px), rgb(var(--accent-3) / 0.08), transparent 70%),
              radial-gradient(360px 360px at var(--mx,50%) var(--my,50%), rgb(0 0 0 / 0.06), transparent 70%);
  mix-blend-mode: overlay;
  opacity: 0.55;
}
/* Theme-specific blending */
html[data-theme="dark"] .cursor-glow { mix-blend-mode: screen; opacity: 0.7; }
html[data-theme="light"] .cursor-glow { mix-blend-mode: multiply; opacity: 0.6; }

/* Light theme: give cards a subtle inner gradient for prominence */
html[data-theme="light"] .card { 
  background-image: linear-gradient(180deg, rgb(0 0 0 / 0.05), transparent 28%);
  background-blend-mode: normal;
}

/* Animated nav links */
.nav-link { position: relative; padding-bottom: 2px; transition: color .2s ease, transform .2s ease; }
.nav-link::after {
  content: ""; position: absolute; left: 0; right: 0; bottom: -3px; height: 2px;
  background: linear-gradient(90deg, rgba(var(--accent),1) 0%, rgba(var(--accent-2),1) 50%, rgba(var(--accent-3),1) 100%);
  transform: scaleX(0); transform-origin: left; transition: transform .25s ease;
  border-radius: 2px;
}
.nav-link:hover { color: rgb(var(--accent)); transform: translateY(-1px); }
.nav-link:hover::after { transform: scaleX(1); }
.nav-link:focus-visible { outline: none; color: rgb(var(--accent)); }

* { transition: color .15s ease, background-color .15s ease, border-color .15s ease, transform .2s ease; }

@media (prefers-reduced-motion: reduce) {
  * { transition: none !important; animation: none !important; }
}

/* Skip to content link */
.skip-link { position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden; }
.skip-link:focus { left: 1rem; top: 1rem; width: auto; height: auto; padding: .5rem .75rem; border-radius: .5rem; background: var(--brand); color: var(--brand-contrast); z-index: 100; box-shadow: 0 4px 14px rgb(0 0 0 / .2); }
